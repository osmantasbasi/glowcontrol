
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>glowcontrol</title>
    <meta name="description" content="Lovable Generated Project" />
    <meta name="author" content="Lovable" />
    <meta property="og:image" content="/og-image.png" />
    <!-- Polyfill Buffer before any other scripts -->
    <script>
      // Ensure we have global objects needed by polyfills
      window.process = window.process || { env: {} };
    </script>
    <!-- Use the buffer polyfill -->
    <script src="https://cdn.jsdelivr.net/npm/buffer@6.0.3/index.min.js"></script>
    <!-- Explicitly initialize Buffer immediately -->
    <script>
      (function ensureBufferImmediately() {
        try {
          // Force Buffer initialization from the polyfill
          if (typeof window.buffer !== 'undefined' && window.buffer.Buffer) {
            window.Buffer = window.buffer.Buffer;
            
            // Make sure Buffer.from is available and is a function
            if (typeof window.Buffer.from !== 'function') {
              console.warn('Buffer.from missing, creating polyfill');
              
              // Create Buffer.from polyfill if needed
              window.Buffer.from = function(data, encoding) {
                if (typeof data === 'string') {
                  // Handle string conversion
                  return new window.Buffer(data, encoding);
                } else if (data instanceof Uint8Array) {
                  // Handle Uint8Array conversion
                  const buf = new window.Buffer(data.length);
                  for (let i = 0; i < data.length; i++) {
                    buf[i] = data[i];
                  }
                  return buf;
                } else if (Array.isArray(data)) {
                  // Handle array conversion
                  return new window.Buffer(data);
                } else {
                  // Default fallback
                  return new window.Buffer(data || 0);
                }
              };
            }
            
            // Test Buffer.from to verify it works
            try {
              var testBuffer = window.Buffer.from('test');
              console.log('âœ“ Buffer.from test successful in head:', 
                testBuffer instanceof Uint8Array, 
                'Content:', Array.from(testBuffer).toString());
            } catch (e) {
              console.error('Buffer.from test failed in head:', e);
            }
          } else {
            console.error('buffer polyfill not loaded properly');
          }
          
          // Explicitly expose Buffer to global scope
          window.globalThis = window.globalThis || window;
          window.globalThis.Buffer = window.Buffer;
        } catch (e) {
          console.error('Error in Buffer setup:', e);
        }
      })();
    </script>
  </head>

  <body>
    <div id="root"></div>
    <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
